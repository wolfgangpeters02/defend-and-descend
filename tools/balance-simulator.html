<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System: Reboot - Balance Simulator</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="balance-simulator.css">
</head>
<body>
    <h1>BALANCE SIMULATOR</h1>
    <p class="subtitle">System: Reboot // Tuning Dashboard</p>

    <div class="tabs">
        <div class="tab active" data-panel="protocols">Protocol Leveling</div>
        <div class="tab" data-panel="hash">Hash Economy</div>
        <div class="tab" data-panel="power">Power Grid</div>
        <div class="tab" data-panel="threat">Threat System</div>
        <div class="tab" data-panel="bosses">Boss Tuning</div>
        <div class="tab" data-panel="components">Components</div>
        <div class="tab" data-panel="protocolCompare">Protocol Compare</div>
        <div class="tab" data-panel="efficiency">Efficiency/Freeze</div>
        <div class="tab" data-panel="sectors">Sector Progression</div>
        <div class="tab" data-panel="export">Export/Import</div>
    </div>

    <!-- PROTOCOL LEVELING PANEL -->
    <div id="protocols" class="panel active">
        <div class="cause-effect">
            <div class="cause">If you increase level multiplier...</div>
            <div class="effect"><strong>Higher levels deal more damage</strong>, but upgrade costs also grow exponentially. Balance determines how "worth it" late upgrades feel.</div>
        </div>

        <div class="grid">
            <div class="card">
                <h3>Level Scaling Config</h3>
                <div class="input-row">
                    <div class="input-group">
                        <label>Damage Multiplier per Level</label>
                        <input type="number" id="proto-dmg-mult" value="1.0" step="0.1">
                    </div>
                    <div class="input-group">
                        <label>Max Protocol Level</label>
                        <input type="number" id="proto-max-level" value="10" min="5" max="20">
                    </div>
                </div>
                <div class="input-row">
                    <div class="input-group">
                        <label>Range per Level (%)</label>
                        <input type="number" id="proto-range-mult" value="0.05" step="0.01">
                    </div>
                    <div class="input-group">
                        <label>Fire Rate per Level (%)</label>
                        <input type="number" id="proto-fire-mult" value="0.03" step="0.01">
                    </div>
                </div>

                <h3 style="margin-top:20px">Upgrade Costs (Base Hash)</h3>
                <div class="input-row">
                    <div class="input-group">
                        <label>Common Base Cost</label>
                        <input type="number" id="cost-common" value="50">
                    </div>
                    <div class="input-group">
                        <label>Rare Base Cost</label>
                        <input type="number" id="cost-rare" value="100">
                    </div>
                </div>
                <div class="input-row">
                    <div class="input-group">
                        <label>Epic Base Cost</label>
                        <input type="number" id="cost-epic" value="200">
                    </div>
                    <div class="input-group">
                        <label>Legendary Base Cost</label>
                        <input type="number" id="cost-legendary" value="400">
                    </div>
                </div>
                <div class="input-group">
                    <label>Cost Scaling Formula</label>
                    <select id="cost-formula">
                        <option value="exponential">Exponential: base * 2^(level-1)</option>
                        <option value="linear">Linear: base * level</option>
                        <option value="quadratic">Quadratic: base * level^2</option>
                    </select>
                </div>

                <div class="button-row">
                    <button onclick="updateProtocolChart()">Calculate</button>
                </div>
            </div>

            <div class="card">
                <h3>Damage Progression (Lv 1-10)</h3>
                <div class="cause-effect">
                    <div class="cause">Level multiplier = level number</div>
                    <div class="effect">Lv1 = 1x damage, Lv5 = 5x damage, Lv10 = <strong id="max-dmg-display">10x</strong> damage</div>
                </div>
                <div class="chart-container">
                    <canvas id="damageChart"></canvas>
                </div>
            </div>
        </div>

        <div class="card">
            <h3>Upgrade Cost Breakdown by Rarity</h3>
            <div class="cause-effect">
                <div class="cause">Total cost Lv1 to Lv10 = sum of all upgrade costs</div>
                <div class="effect">Players need this much Hash to fully max a protocol. <strong>Higher = longer grind</strong>.</div>
            </div>
            <table class="result-table" id="upgrade-cost-table">
                <thead>
                    <tr>
                        <th>Level</th>
                        <th class="rarity-common">Common</th>
                        <th class="rarity-rare">Rare</th>
                        <th class="rarity-epic">Epic</th>
                        <th class="rarity-legendary">Legendary</th>
                        <th>Damage</th>
                        <th>DPS Gain</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            <div class="summary-box">
                <h4>Total Cost to Max (Lv1 -> Lv10)</h4>
                <ul id="total-cost-summary"></ul>
            </div>
        </div>
    </div>

    <!-- HASH ECONOMY PANEL -->
    <div id="hash" class="panel">
        <div class="cause-effect">
            <div class="cause">If you increase Hash per second...</div>
            <div class="effect"><strong>Players accumulate currency faster</strong>, affording towers/upgrades sooner. Too fast = trivial economy. Too slow = frustrating wait.</div>
        </div>

        <div class="grid">
            <div class="card">
                <h3>Hash Production</h3>
                <div class="input-row">
                    <div class="input-group">
                        <label>Base Hash/sec (CPU Lv1)</label>
                        <input type="number" id="hash-base" value="1.0" step="0.1">
                    </div>
                    <div class="input-group">
                        <label>CPU Level Multiplier</label>
                        <input type="number" id="hash-cpu-mult" value="1.5" step="0.1">
                    </div>
                </div>

                <h3 style="margin-top:20px">Storage Capacity</h3>
                <div class="input-row">
                    <div class="input-group">
                        <label>Base Storage (DDR4)</label>
                        <input type="number" id="storage-base" value="500">
                    </div>
                    <div class="input-group">
                        <label>Storage per Upgrade</label>
                        <input type="number" id="storage-per-level" value="500">
                    </div>
                </div>
                <div class="input-group">
                    <label>Max Storage Tier</label>
                    <input type="number" id="storage-max-tier" value="8">
                </div>

                <h3 style="margin-top:20px">Multipliers</h3>
                <div class="input-row">
                    <div class="input-group">
                        <label>Overclock Multiplier</label>
                        <input type="number" id="overclock-mult" value="2.0" step="0.1">
                    </div>
                    <div class="input-group">
                        <label>Overclock Duration (sec)</label>
                        <input type="number" id="overclock-duration" value="60">
                    </div>
                </div>
                <div class="input-row">
                    <div class="input-group">
                        <label>Online Efficiency (%)</label>
                        <input type="number" id="online-efficiency" value="100" min="0" max="100">
                    </div>
                    <div class="input-group">
                        <label>Offline Earnings (%)</label>
                        <input type="number" id="offline-rate" value="20" min="0" max="100">
                    </div>
                </div>
                <div class="input-group">
                    <label>Max Offline Hours</label>
                    <input type="number" id="offline-max-hours" value="8">
                </div>

                <div class="button-row">
                    <button onclick="updateHashChart()">Calculate</button>
                </div>
            </div>

            <div class="card">
                <h3>Hash Rate by CPU Level</h3>
                <div class="cause-effect">
                    <div class="cause">CPU Level increases Hash/sec exponentially</div>
                    <div class="effect">Rate = base * mult^(level-1). <strong>Higher CPU = faster income</strong>.</div>
                </div>
                <div class="chart-container">
                    <canvas id="hashRateChart"></canvas>
                </div>
            </div>
        </div>

        <div class="grid">
            <div class="card">
                <h3>Hash Accumulation Over Time</h3>
                <div class="cause-effect">
                    <div class="cause">Comparing CPU levels over 10 minutes</div>
                    <div class="effect">Shows how much Hash each CPU tier earns. <strong>Gap = upgrade incentive</strong>.</div>
                </div>
                <div class="chart-container">
                    <canvas id="hashAccumChart"></canvas>
                </div>
            </div>

            <div class="card">
                <h3>Storage & Offline Summary</h3>
                <table class="result-table" id="storage-table">
                    <thead>
                        <tr><th>Tier</th><th>Capacity</th><th>Fill Time (Lv1 CPU)</th><th>Offline Cap (8h)</th></tr>
                    </thead>
                    <tbody></tbody>
                </table>
                <div class="summary-box">
                    <h4>Offline Earnings Example</h4>
                    <ul id="offline-summary"></ul>
                </div>
            </div>
        </div>
    </div>

    <!-- POWER GRID PANEL -->
    <div id="power" class="panel">
        <div class="cause-effect">
            <div class="cause">If power demand exceeds supply...</div>
            <div class="effect"><strong>Towers shut down</strong> and Hash production stops. Players must balance tower count against CPU power budget.</div>
        </div>

        <div class="grid">
            <div class="card">
                <h3>Power Supply (CPU)</h3>
                <div class="input-row">
                    <div class="input-group">
                        <label>Base Power (Watts)</label>
                        <input type="number" id="power-base" value="100">
                    </div>
                    <div class="input-group">
                        <label>Power per CPU Level</label>
                        <input type="number" id="power-per-level" value="50">
                    </div>
                </div>
                <div class="input-group">
                    <label>Max CPU Level</label>
                    <input type="number" id="power-max-cpu" value="10">
                </div>

                <h3 style="margin-top:20px">Tower Power Draw</h3>
                <div class="input-row">
                    <div class="input-group">
                        <label>Common (W)</label>
                        <input type="number" id="tower-power-common" value="15">
                    </div>
                    <div class="input-group">
                        <label>Rare (W)</label>
                        <input type="number" id="tower-power-rare" value="20">
                    </div>
                </div>
                <div class="input-row">
                    <div class="input-group">
                        <label>Epic (W)</label>
                        <input type="number" id="tower-power-epic" value="30">
                    </div>
                    <div class="input-group">
                        <label>Legendary (W)</label>
                        <input type="number" id="tower-power-legendary" value="40">
                    </div>
                </div>
                <div class="input-group">
                    <label>Power per Tower Level (%)</label>
                    <input type="number" id="tower-power-scaling" value="0" step="1">
                </div>

                <h3 style="margin-top:20px">Overclock Power</h3>
                <div class="input-group">
                    <label>Overclock Power Multiplier</label>
                    <input type="number" id="overclock-power-mult" value="2.0" step="0.1">
                </div>

                <div class="button-row">
                    <button onclick="updatePowerChart()">Calculate</button>
                </div>
            </div>

            <div class="card">
                <h3>Power Budget by CPU Level</h3>
                <div class="cause-effect">
                    <div class="cause">Total Power = base + (level * perLevel)</div>
                    <div class="effect"><strong>Higher CPU = more towers allowed</strong>.</div>
                </div>
                <div class="chart-container">
                    <canvas id="powerChart"></canvas>
                </div>
            </div>
        </div>

        <div class="card">
            <h3>Max Towers per CPU Level</h3>
            <div class="cause-effect">
                <div class="cause">Max towers = power budget / tower power draw</div>
                <div class="effect">Shows how many towers of each rarity fit in the power budget. <strong>Constraint = strategic choice</strong>.</div>
            </div>
            <table class="result-table" id="tower-limit-table">
                <thead>
                    <tr>
                        <th>CPU Level</th>
                        <th>Power Budget</th>
                        <th class="rarity-common">Max Common</th>
                        <th class="rarity-rare">Max Rare</th>
                        <th class="rarity-epic">Max Epic</th>
                        <th class="rarity-legendary">Max Legendary</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <!-- THREAT SYSTEM PANEL -->
    <div id="threat" class="panel">
        <div class="cause-effect">
            <div class="cause">If threat growth rate increases...</div>
            <div class="effect"><strong>Enemies get stronger faster</strong>, unlocking harder enemy types sooner. Resets give players a chance to rebuild.</div>
        </div>

        <div class="grid">
            <div class="card">
                <h3>Threat Scaling</h3>
                <div class="input-row">
                    <div class="input-group">
                        <label>Online Threat Growth (/sec)</label>
                        <input type="number" id="threat-online-rate" value="0.01" step="0.001">
                    </div>
                    <div class="input-group">
                        <label>Offline Threat Growth (/sec)</label>
                        <input type="number" id="threat-offline-rate" value="0.001" step="0.0001">
                    </div>
                </div>
                <div class="input-row">
                    <div class="input-group">
                        <label>HP Scaling per Threat</label>
                        <input type="number" id="threat-hp-scale" value="0.15" step="0.01">
                    </div>
                    <div class="input-group">
                        <label>Speed Scaling per Threat</label>
                        <input type="number" id="threat-speed-scale" value="0.02" step="0.01">
                    </div>
                </div>
                <div class="input-row">
                    <div class="input-group">
                        <label>Damage Scaling per Threat</label>
                        <input type="number" id="threat-dmg-scale" value="0.05" step="0.01">
                    </div>
                    <div class="input-group">
                        <label>Max Threat Level</label>
                        <input type="number" id="threat-max" value="100">
                    </div>
                </div>

                <h3 style="margin-top:20px">Enemy Unlock Thresholds</h3>
                <div class="input-row">
                    <div class="input-group">
                        <label>Fast Enemy @</label>
                        <input type="number" id="unlock-fast" value="2.0" step="0.5">
                    </div>
                    <div class="input-group">
                        <label>Swarm Enemy @</label>
                        <input type="number" id="unlock-swarm" value="4.0" step="0.5">
                    </div>
                </div>
                <div class="input-row">
                    <div class="input-group">
                        <label>Tank Enemy @</label>
                        <input type="number" id="unlock-tank" value="5.0" step="0.5">
                    </div>
                    <div class="input-group">
                        <label>Elite Enemy @</label>
                        <input type="number" id="unlock-elite" value="8.0" step="0.5">
                    </div>
                </div>
                <div class="input-group">
                    <label>Mini-Boss Enemy @</label>
                    <input type="number" id="unlock-boss" value="10.0" step="0.5">
                </div>

                <h3 style="margin-top:20px">Threat Reset</h3>
                <div class="input-row">
                    <div class="input-group">
                        <label>Reset Trigger (Efficiency %)</label>
                        <input type="number" id="threat-reset-trigger" value="0">
                    </div>
                    <div class="input-group">
                        <label>Reset To Level</label>
                        <input type="number" id="threat-reset-to" value="1.0" step="0.5">
                    </div>
                </div>

                <div class="button-row">
                    <button onclick="updateThreatChart()">Calculate</button>
                </div>
            </div>

            <div class="card">
                <h3>Stat Multipliers by Threat</h3>
                <div class="cause-effect">
                    <div class="cause">Higher threat = stronger enemies</div>
                    <div class="effect">HP grows fastest, then damage, then speed. <strong>Spongier before deadlier</strong>.</div>
                </div>
                <div class="chart-container">
                    <canvas id="threatChart"></canvas>
                </div>
            </div>
        </div>

        <div class="card">
            <h3>Threat Timeline (Online Play)</h3>
            <div class="cause-effect">
                <div class="cause">Time to reach each enemy unlock threshold</div>
                <div class="effect">Shows when new enemy types appear. <strong>Pacing = player pressure curve</strong>.</div>
            </div>
            <table class="result-table" id="threat-timeline-table">
                <thead>
                    <tr>
                        <th>Event</th>
                        <th>Threat Level</th>
                        <th>Time (Online)</th>
                        <th>HP Mult</th>
                        <th>Speed Mult</th>
                        <th>Damage Mult</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <!-- BOSS TUNING PANEL -->
    <div id="bosses" class="panel">
        <div class="cause-effect">
            <div class="cause">If boss HP/damage increases...</div>
            <div class="effect"><strong>Fights take longer and punish mistakes more</strong>. Phase thresholds create pacing; abilities create mechanics.</div>
        </div>

        <div class="grid">
            <div class="card">
                <h3>Cyberboss (TD Mode Boss)</h3>
                <div class="input-row">
                    <div class="input-group">
                        <label>Base HP</label>
                        <input type="number" id="cyber-hp" value="4000">
                    </div>
                    <div class="input-group">
                        <label>HP Scaling / Wave</label>
                        <input type="number" id="cyber-hp-scale" value="0.15" step="0.01">
                    </div>
                </div>
                <div class="input-row">
                    <div class="input-group">
                        <label>Laser Damage</label>
                        <input type="number" id="cyber-laser-dmg" value="50">
                    </div>
                    <div class="input-group">
                        <label>Laser Warning (sec)</label>
                        <input type="number" id="cyber-laser-warn" value="1.5" step="0.1">
                    </div>
                </div>
                <div class="input-row">
                    <div class="input-group">
                        <label>Puddle Damage/sec</label>
                        <input type="number" id="cyber-puddle-dmg" value="20">
                    </div>
                    <div class="input-group">
                        <label>Puddle Duration (sec)</label>
                        <input type="number" id="cyber-puddle-dur" value="5.0" step="0.5">
                    </div>
                </div>
                <div class="input-row">
                    <div class="input-group">
                        <label>Spawn Wave Size</label>
                        <input type="number" id="cyber-spawn-count" value="5">
                    </div>
                    <div class="input-group">
                        <label>Spawn Interval (sec)</label>
                        <input type="number" id="cyber-spawn-interval" value="8">
                    </div>
                </div>

                <h3 style="margin-top:20px">Phase Thresholds (%HP)</h3>
                <div class="input-row">
                    <div class="input-group">
                        <label>Phase 2 @</label>
                        <input type="number" id="cyber-phase2" value="75">
                    </div>
                    <div class="input-group">
                        <label>Phase 3 @</label>
                        <input type="number" id="cyber-phase3" value="50">
                    </div>
                    <div class="input-group">
                        <label>Phase 4 @</label>
                        <input type="number" id="cyber-phase4" value="25">
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>Zero-Day Virus (Survival Boss)</h3>
                <div class="input-row">
                    <div class="input-group">
                        <label>Base HP</label>
                        <input type="number" id="zeroday-hp" value="9999">
                    </div>
                    <div class="input-group">
                        <label>Speed</label>
                        <input type="number" id="zeroday-speed" value="30">
                    </div>
                </div>
                <div class="input-row">
                    <div class="input-group">
                        <label>Efficiency Drain/sec</label>
                        <input type="number" id="zeroday-drain" value="2.0" step="0.1">
                    </div>
                    <div class="input-group">
                        <label>Min Waves Before Spawn</label>
                        <input type="number" id="zeroday-min-waves" value="3">
                    </div>
                </div>
                <div class="input-row">
                    <div class="input-group">
                        <label>Defeat Hash Bonus</label>
                        <input type="number" id="zeroday-hash" value="525">
                    </div>
                    <div class="input-group">
                        <label>Defeat Efficiency Restore</label>
                        <input type="number" id="zeroday-restore" value="30">
                    </div>
                </div>

                <div class="button-row">
                    <button onclick="updateBossChart()">Calculate</button>
                </div>
            </div>
        </div>

        <div class="grid">
            <div class="card">
                <h3>Cyberboss HP by Wave</h3>
                <div class="cause-effect">
                    <div class="cause">Boss HP scales with wave number</div>
                    <div class="effect">Later bosses = longer fights. <strong>TTK matters for pacing</strong>.</div>
                </div>
                <div class="chart-container">
                    <canvas id="bossHpChart"></canvas>
                </div>
            </div>

            <div class="card">
                <h3>Cyberboss Phase Visualization</h3>
                <div class="cause-effect">
                    <div class="cause">Each phase adds new abilities</div>
                    <div class="effect"><strong>Phase 1:</strong> Basic attacks | <strong>Phase 2:</strong> +Lasers | <strong>Phase 3:</strong> +Puddles | <strong>Phase 4:</strong> Enrage</div>
                </div>
                <div class="phase-timeline" id="phase-timeline">
                    <div class="phase-block">
                        <div class="phase-name">Phase 1</div>
                        <div class="phase-hp">100% - 76%</div>
                    </div>
                    <div class="phase-block">
                        <div class="phase-name">Phase 2</div>
                        <div class="phase-hp">75% - 51%</div>
                    </div>
                    <div class="phase-block">
                        <div class="phase-name">Phase 3</div>
                        <div class="phase-hp">50% - 26%</div>
                    </div>
                    <div class="phase-block">
                        <div class="phase-name">Phase 4</div>
                        <div class="phase-hp">25% - 0%</div>
                    </div>
                </div>

                <table class="result-table" style="margin-top:20px">
                    <thead>
                        <tr><th>Ability</th><th>Damage</th><th>Timing</th><th>Threat Level</th></tr>
                    </thead>
                    <tbody id="boss-ability-table"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- COMPONENT UPGRADES PANEL -->
    <div id="components" class="panel">
        <div class="cause-effect">
            <div class="cause">If you increase component upgrade costs...</div>
            <div class="effect"><strong>Players progress slower through the component tree</strong>. Each component buffs a different system — PSU unlocks power, GPU boosts damage, Network boosts Hash income.</div>
        </div>

        <div class="grid">
            <div class="card">
                <h3>Component Upgrade Config</h3>
                <div class="input-group">
                    <label>Max Component Level</label>
                    <input type="number" id="comp-max-level" value="10" min="1" max="20">
                </div>
                <div class="input-group">
                    <label>Cost Formula</label>
                    <select id="comp-cost-formula" disabled>
                        <option value="exponential">Exponential: base × 2^(level-1)</option>
                    </select>
                </div>

                <h3 style="margin-top:20px">Base Upgrade Costs (Hash)</h3>
                <div class="input-row">
                    <div class="input-group">
                        <label>PSU (Power)</label>
                        <input type="number" id="comp-cost-psu" value="500">
                    </div>
                    <div class="input-group">
                        <label>RAM (Efficiency)</label>
                        <input type="number" id="comp-cost-ram" value="400">
                    </div>
                </div>
                <div class="input-row">
                    <div class="input-group">
                        <label>GPU (Damage)</label>
                        <input type="number" id="comp-cost-gpu" value="600">
                    </div>
                    <div class="input-group">
                        <label>Cache (Atk Speed)</label>
                        <input type="number" id="comp-cost-cache" value="550">
                    </div>
                </div>
                <div class="input-row">
                    <div class="input-group">
                        <label>Storage (Capacity)</label>
                        <input type="number" id="comp-cost-storage" value="400">
                    </div>
                    <div class="input-group">
                        <label>Expansion (Slots)</label>
                        <input type="number" id="comp-cost-expansion" value="800">
                    </div>
                </div>
                <div class="input-row">
                    <div class="input-group">
                        <label>Network (Hash Mult)</label>
                        <input type="number" id="comp-cost-network" value="1000">
                    </div>
                    <div class="input-group">
                        <label>I/O (Pickup Range)</label>
                        <input type="number" id="comp-cost-io" value="450">
                    </div>
                </div>
                <div class="input-group">
                    <label>CPU (Hash/sec)</label>
                    <input type="number" id="comp-cost-cpu" value="750">
                </div>

                <div class="button-row">
                    <button onclick="updateComponentChart()">Calculate</button>
                </div>
            </div>

            <div class="card">
                <h3>Upgrade Cost Curves (All Components)</h3>
                <div class="cause-effect">
                    <div class="cause">Cost = baseCost × 2^(level-1)</div>
                    <div class="effect">More expensive components (Network, Expansion) create <strong>higher total investment</strong> requirements.</div>
                </div>
                <div class="chart-container">
                    <canvas id="componentCostChart"></canvas>
                </div>
            </div>
        </div>

        <div class="card">
            <h3>Component Stat Progression (Lv 1–10)</h3>
            <div class="cause-effect">
                <div class="cause">Each component buffs a unique system stat</div>
                <div class="effect"><strong>PSU</strong> = power capacity, <strong>GPU</strong> = tower damage, <strong>RAM</strong> = efficiency recovery, <strong>Cache</strong> = attack speed, <strong>Network</strong> = Hash multiplier.</div>
            </div>
            <table class="result-table" id="component-stat-table">
                <thead>
                    <tr>
                        <th>Lv</th>
                        <th>PSU (W)</th>
                        <th>GPU (Dmg×)</th>
                        <th>Cache (Spd×)</th>
                        <th>RAM (Regen×)</th>
                        <th>Network (Hash×)</th>
                        <th>I/O (Pickup×)</th>
                        <th>Storage (Cap)</th>
                        <th>Expansion (+Slots)</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            <div class="summary-box">
                <h4>Total Upgrade Cost per Component (Lv1 → Lv10)</h4>
                <ul id="comp-total-cost-summary"></ul>
            </div>
        </div>
    </div>

    <!-- PROTOCOL COMPARISON PANEL -->
    <div id="protocolCompare" class="panel">
        <div class="cause-effect">
            <div class="cause">If one protocol outperforms others at the same rarity...</div>
            <div class="effect"><strong>Players will always pick it</strong>. Compare DPS, cost-efficiency, and power draw to ensure meaningful trade-offs within each tier.</div>
        </div>

        <div class="grid">
            <div class="card">
                <h3>Protocol Level</h3>
                <div class="input-row">
                    <div class="input-group">
                        <label>Compare at Level</label>
                        <input type="range" id="proto-compare-level" min="1" max="10" value="1" oninput="updateProtocolCompare()">
                        <span id="proto-compare-level-display" style="color:var(--accent-cyan)">Lv 1</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="card">
            <h3>Firewall Mode (Tower Defense)</h3>
            <div class="cause-effect">
                <div class="cause">Damage × FireRate = raw DPS, but specials change effective value</div>
                <div class="effect">Chain/splash/multi-shot protocols deal more <strong>effective DPS</strong> than raw numbers suggest.</div>
            </div>
            <table class="result-table" id="proto-firewall-table">
                <thead>
                    <tr>
                        <th>Protocol</th>
                        <th>Rarity</th>
                        <th>Damage</th>
                        <th>Fire Rate</th>
                        <th>Range</th>
                        <th>DPS</th>
                        <th>Power (W)</th>
                        <th>DPS/Watt</th>
                        <th>Special</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>

        <div class="card" style="margin-top:20px">
            <h3>Weapon Mode (Active/Boss)</h3>
            <table class="result-table" id="proto-weapon-table">
                <thead>
                    <tr>
                        <th>Protocol</th>
                        <th>Rarity</th>
                        <th>Damage</th>
                        <th>Fire Rate</th>
                        <th>Projectiles</th>
                        <th>DPS</th>
                        <th>Special</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>

        <div class="grid" style="margin-top:20px">
            <div class="card">
                <h3>Firewall DPS Comparison</h3>
                <div class="chart-container">
                    <canvas id="protoDpsChart"></canvas>
                </div>
            </div>
            <div class="card">
                <h3>DPS per Watt (Power Efficiency)</h3>
                <div class="chart-container">
                    <canvas id="protoPowerEffChart"></canvas>
                </div>
            </div>
        </div>

        <div class="card" style="margin-top:20px">
            <h3>Upgrade Cost & Compile Cost</h3>
            <table class="result-table" id="proto-cost-table">
                <thead>
                    <tr>
                        <th>Protocol</th>
                        <th>Rarity</th>
                        <th>Compile Cost</th>
                        <th>Upgrade Base</th>
                        <th>Total Lv1→10</th>
                        <th>DPS at Lv10</th>
                        <th>Hash per DPS</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <!-- EFFICIENCY / FREEZE PANEL -->
    <div id="efficiency" class="panel">
        <div class="cause-effect">
            <div class="cause">If efficiency drops to 0%...</div>
            <div class="effect"><strong>System freezes</strong> — towers stop firing, Hash stops generating. Players must pay Hash to recover. RAM upgrades speed up natural recovery.</div>
        </div>

        <div class="grid">
            <div class="card">
                <h3>Efficiency System Config</h3>
                <div class="input-row">
                    <div class="input-group">
                        <label>Leak Decay Interval (sec)</label>
                        <input type="number" id="eff-leak-interval" value="5.0" step="0.5">
                    </div>
                    <div class="input-group">
                        <label>Warning Threshold (%)</label>
                        <input type="number" id="eff-warning" value="25" min="0" max="100">
                    </div>
                </div>

                <h3 style="margin-top:20px">Freeze Recovery</h3>
                <div class="input-row">
                    <div class="input-group">
                        <label>Recovery Cost (% of Hash)</label>
                        <input type="number" id="freeze-cost-pct" value="10" min="1" max="100">
                    </div>
                    <div class="input-group">
                        <label>Recovery Target Efficiency (%)</label>
                        <input type="number" id="freeze-target-eff" value="50" min="1" max="100">
                    </div>
                </div>

                <h3 style="margin-top:20px">RAM Upgrade Impact</h3>
                <div class="input-row">
                    <div class="input-group">
                        <label>Base Regen Multiplier</label>
                        <input type="number" id="ram-base-regen" value="1.0" step="0.1">
                    </div>
                    <div class="input-group">
                        <label>Regen per RAM Level</label>
                        <input type="number" id="ram-regen-per-level" value="0.111" step="0.001">
                    </div>
                </div>

                <div class="button-row">
                    <button onclick="updateEfficiencyChart()">Calculate</button>
                </div>
            </div>

            <div class="card">
                <h3>RAM Efficiency Recovery by Level</h3>
                <div class="cause-effect">
                    <div class="cause">Higher RAM = faster natural recovery</div>
                    <div class="effect">At Lv10, recovery is <strong>2× faster</strong> than Lv1. Reduces need for expensive freeze flush.</div>
                </div>
                <div class="chart-container">
                    <canvas id="efficiencyChart"></canvas>
                </div>
            </div>
        </div>

        <div class="grid">
            <div class="card">
                <h3>Freeze Recovery Cost Examples</h3>
                <div class="cause-effect">
                    <div class="cause">Cost = currentHash / recoveryDivisor</div>
                    <div class="effect">Costs more when you have more Hash. <strong>Early game = cheap, late game = expensive</strong>.</div>
                </div>
                <table class="result-table" id="freeze-cost-table">
                    <thead>
                        <tr>
                            <th>Current Hash</th>
                            <th>Recovery Cost</th>
                            <th>Restores To</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>

            <div class="card">
                <h3>Efficiency Decay Timeline</h3>
                <div class="cause-effect">
                    <div class="cause">Each leak reduces efficiency at the decay interval</div>
                    <div class="effect">Shows time until <strong>freeze threshold</strong> at different leak rates. Higher RAM level extends survival time.</div>
                </div>
                <table class="result-table" id="eff-decay-table">
                    <thead>
                        <tr>
                            <th>Leaks/min</th>
                            <th>Time to Warning (25%)</th>
                            <th>Time to Freeze (0%)</th>
                            <th>RAM Lv5 (to Freeze)</th>
                            <th>RAM Lv10 (to Freeze)</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- SECTOR PROGRESSION PANEL -->
    <div id="sectors" class="panel">
        <div class="cause-effect">
            <div class="cause">If sector unlock costs increase faster...</div>
            <div class="effect"><strong>Players spend more time per sector</strong>, fully upgrading before expanding. Lower costs = faster expansion but weaker per-sector investment.</div>
        </div>

        <div class="grid">
            <div class="card">
                <h3>Sector Unlock Costs (Hash)</h3>
                <div class="input-row">
                    <div class="input-group">
                        <label>PSU (Starter)</label>
                        <input type="number" id="sector-cost-0" value="0" disabled>
                    </div>
                    <div class="input-group">
                        <label>RAM</label>
                        <input type="number" id="sector-cost-1" value="25000">
                    </div>
                </div>
                <div class="input-row">
                    <div class="input-group">
                        <label>GPU</label>
                        <input type="number" id="sector-cost-2" value="50000">
                    </div>
                    <div class="input-group">
                        <label>Cache</label>
                        <input type="number" id="sector-cost-3" value="75000">
                    </div>
                </div>
                <div class="input-row">
                    <div class="input-group">
                        <label>Storage</label>
                        <input type="number" id="sector-cost-4" value="100000">
                    </div>
                    <div class="input-group">
                        <label>Expansion</label>
                        <input type="number" id="sector-cost-5" value="150000">
                    </div>
                </div>
                <div class="input-row">
                    <div class="input-group">
                        <label>Network</label>
                        <input type="number" id="sector-cost-6" value="200000">
                    </div>
                    <div class="input-group">
                        <label>I/O</label>
                        <input type="number" id="sector-cost-7" value="300000">
                    </div>
                </div>
                <div class="input-group">
                    <label>CPU (Final)</label>
                    <input type="number" id="sector-cost-8" value="500000">
                </div>

                <div class="button-row">
                    <button onclick="updateSectorChart()">Calculate</button>
                </div>
            </div>

            <div class="card">
                <h3>Unlock Cost & Cumulative Investment</h3>
                <div class="cause-effect">
                    <div class="cause">Total investment to reach each sector</div>
                    <div class="effect">Cumulative cost shows the <strong>full price of expansion</strong>. Final unlock (CPU) requires 1.4M total Hash.</div>
                </div>
                <div class="chart-container">
                    <canvas id="sectorCostChart"></canvas>
                </div>
            </div>
        </div>

        <div class="grid">
            <div class="card">
                <h3>Sector Hash Bonus Multipliers</h3>
                <div class="cause-effect">
                    <div class="cause">Later sectors reward more Hash per enemy</div>
                    <div class="effect">CPU sector gives <strong>3× Hash</strong> vs starter. Encourages expansion despite higher costs.</div>
                </div>
                <div class="chart-container">
                    <canvas id="sectorBonusChart"></canvas>
                </div>
            </div>

            <div class="card">
                <h3>Time to Unlock (at CPU Lv1 Hash Rate)</h3>
                <div class="cause-effect">
                    <div class="cause">Time = cost / hashPerSecond</div>
                    <div class="effect">At 1 Ħ/s base rate, unlocking all sectors takes a <strong>very long time</strong> — incentivizes CPU upgrades first.</div>
                </div>
                <table class="result-table" id="sector-timeline-table">
                    <thead>
                        <tr>
                            <th>Sector</th>
                            <th>Unlock Cost</th>
                            <th>Cumulative</th>
                            <th>Hash Bonus</th>
                            <th>Time @ 1 Ħ/s</th>
                            <th>Time @ 5 Ħ/s</th>
                            <th>Time @ 38 Ħ/s</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- EXPORT/IMPORT PANEL -->
    <div id="export" class="panel">
        <div class="cause-effect">
            <div class="cause">Export your tuned values</div>
            <div class="effect">Copy JSON to update BalanceConfig.swift or share with team.</div>
        </div>

        <div class="grid">
            <div class="card">
                <h3>Export Configuration</h3>
                <textarea class="export-area" id="export-json" readonly></textarea>
                <div class="button-row">
                    <button onclick="generateExport()">Generate JSON</button>
                    <button class="secondary" onclick="copyToClipboard('export-json')">Copy</button>
                </div>
            </div>

            <div class="card">
                <h3>Import Configuration</h3>
                <textarea class="export-area" id="import-json" placeholder="Paste JSON here..."></textarea>
                <div class="button-row">
                    <button onclick="importConfig()">Import</button>
                </div>
            </div>
        </div>

        <div class="card">
            <h3>Swift Code Generation</h3>
            <textarea class="export-area" id="swift-export" readonly style="height:400px"></textarea>
            <div class="button-row">
                <button onclick="generateSwiftCode()">Generate Swift</button>
                <button class="secondary" onclick="copyToClipboard('swift-export')">Copy</button>
            </div>
        </div>
    </div>

    <script src="balance-simulator.js"></script>
</body>
</html>
